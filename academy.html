<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Writer's Academy</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Lora:ital@0;1&family=Source+Sans+Pro&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <style>
        :root {
            --bg-slate: #2D3748; --accent-gold: #D4AF37; --accent-green: #8A9A5B;
            --success-green: #22c55e; --error-red: #ef4444;
            --intermediate-blue: #3b82f6;
        }
        body { background-color: #FDFDFD; font-family: 'Lora', serif; color: #1f2937; }
        h1, h2, h3, h4 { font-family: 'Playfair Display', serif; color: var(--bg-slate); }
        .ui-font { font-family: 'Source Sans Pro', sans-serif; }
        header { background-color: var(--bg-slate); }
        .card-premium-unlocked { border-left: 4px solid var(--accent-gold); }
        .card-premium-locked { border-left: 4px solid #d1d5db; }
        .card-free { border-left: 4px solid var(--accent-green); }
        
        .lesson-container { max-width: 800px; margin-left: auto; margin-right: auto; padding-left: 1rem; padding-right: 1rem; }
        #lesson-header { text-align: center; }
        #lesson-content h1 { font-size: 2.25rem; margin-top: 0; margin-bottom: 1rem; }
        #lesson-content h2 { font-size: 1.75rem; margin-top: 2.5rem; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px dashed #d1d5db; }
        #lesson-content h3 { font-size: 1.5rem; margin-top: 2rem; margin-bottom: 0.75rem; }
        #lesson-content p { font-size: 18px; line-height: 1.8; margin-bottom: 1.5rem; text-align: left; }
        #lesson-content img { max-width: 100%; height: auto; border-radius: 8px; margin: 1.5rem auto; box-shadow: 0 4px 12px rgba(0,0,0,0.1); display: block; }
        #lesson-content blockquote { border-left: 3px solid var(--accent-gold); padding-left: 1.5rem; margin: 1.5rem 0; font-style: italic; color: #555; }
        #lesson-content ul, #lesson-content ol { margin: 1.5rem 0 1.5rem 1.25rem; list-style-position: outside; }
        #lesson-content li { margin-bottom: 0.75rem; padding-left: 0.5rem; line-height: 1.8; }
        
        .quiz-section { background: #fff; border: 1px solid #e2e8f0; border-radius: 8px; padding: 24px; margin-top: 40px; }
        .quiz-options label { display: flex; align-items: center; gap: 10px; padding: 12px 16px; border: 1px solid #e2e8f0; border-radius: 6px; cursor: pointer; transition: all 0.2s; }
        .quiz-options label:hover { border-color: var(--accent-gold); background: #fffaf0; }
        .quiz-options input[type="radio"] { display: none; }
        .quiz-options input[type="radio"]:checked + .option-text { font-weight: 700; color: var(--accent-gold); }
        .quiz-options label.correct { border-color: var(--success-green); background-color: #f0fff4; }
        .quiz-options label.incorrect { border-color: var(--error-red); background-color: #fff5f5; }
        .fill-in-blank-input { border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; font-family: 'Source Sans Pro', sans-serif; }
        .feedback { margin-top: 1rem; padding: 0.75rem; border-radius: 6px; font-weight: 500; display: flex; align-items: center; gap: 8px; }
        .feedback.correct { color: var(--success-green); background-color: #f0fff4; border-left: 4px solid var(--success-green); }
        .feedback.incorrect { color: var(--error-red); background-color: #fff5f5; border-left: 4px solid var(--error-red); }
        #lesson-spark { margin-top: 48px; padding: 24px; background: var(--bg-slate); color: #e2e8f0; border-radius: 8px; border-left: 4px solid var(--accent-gold); }
    </style>
</head>
<body class="text-gray-800">

    <header class="text-white shadow-lg">
        <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-20">
                <a href="./academy.html" class="flex items-center gap-2">
                    <svg class="h-8 w-8" viewBox="0 0 24 24"><path d="M12 2 L2 22 H22 Z M12 6 L18.3 18 H5.7 Z" fill="var(--accent-gold)"/></svg>
                    <span class="font-bold text-2xl">The Academy</span>
                </a>
                <div id="auth-nav" class="text-sm ui-font"></div>
            </div>
        </nav>
    </header>

    <main id="app-container" class="py-12"></main>

    <footer class="mt-24 py-8 text-center text-gray-400" style="background-color: var(--bg-slate);">
        <p class="ui-font">© 2025 Boluadeoye • Crafted with passion</p>
    </footer>

    <script>
        // --- START OF EMBEDDED DATABASE AND AUTH LOGIC ---
        const AppData = {
            lessons: {
                "gram001": { "id": "gram001", "title": "Mastering Subject-Verb Agreement", "access": "free", "summary": "Learn the foundational rule of English syntax.", "insightSpark": "Find a complex paragraph in a book. Why does the subject-verb agreement work?", "difficulty": "Beginner",
                    "content": `<h2>The Core Rule</h2><p>At its heart, subject-verb agreement is simple: a singular subject takes a singular verb, and a plural subject takes a plural verb. The challenge often lies in correctly identifying the subject and ignoring other nouns in the sentence.</p><h2>Common Pitfalls</h2><p>Prepositional phrases, which begin with words like 'of', 'in', 'between', or 'on', can be misleading. For example, in the sentence "The <strong>box</strong> of apples <strong>is</strong> on the table," the subject is "box," which is singular. The phrase "of apples" simply describes the box, so the verb must agree with "box," not "apples."</p>`,
                    "quizzes": [{ "type": "multiple-choice", "prompt": "The pack of wolves ___ to the moon.", "options": ["howl", "howls"], "answer": "howls", "explanation": "The subject is 'pack' (singular), so the verb is 'howls'." }]
                },
                "gram002": { "id": "gram002", "title": "Mastering Pronoun Usage", "access": "free", "summary": "Avoid ambiguity with correct pronoun usage.", "insightSpark": "Write a sentence where the pronoun 'it' is ambiguous, then rewrite it for clarity.", "difficulty": "Intermediate",
                    "content": `<h2>The Role of the Pronoun</h2><p>Pronouns are the efficient stand-ins of the English language. They take the place of nouns to avoid repetition and make our sentences flow more smoothly.</p><h2>Subject vs. Object Pronouns</h2><p>The most common point of confusion is whether to use a subject pronoun or an object pronoun. The rule is simple:</p><ul><li><strong>Subject Pronouns</strong> perform the action of the verb. They are **I, you, he, she, it, we, they.**</li><li><strong>Object Pronouns** receive the action of the verb. They are **me, you, him, her, it, us, them.**</li></ul><p>A simple trick is to remove the other person from the sentence to see what sounds right. You wouldn't say "Me went to the store," so you know to use "She and I."</p>`,
                    "quizzes": [
                        { "type": "multiple-choice", "prompt": "Which sentence is correct?", "options": ["Her and me went to the store.", "She and I went to the store."], "answer": "She and I went to the store.", "explanation": "'She' and 'I' are subject pronouns, used when they are the subject of the verb 'went'." },
                        { "type": "fill-in-the-blank", "prompt": "The dog wagged ___ tail.", "answer": "its", "explanation": "'Its' is the possessive form of 'it'. 'It's' is a contraction for 'it is'." }
                    ]
                },
                "gram003": { "id": "gram003", "title": "The Art of the Semicolon", "access": "premium", "summary": "Connect related clauses with style.", "insightSpark": "Craft a single, beautiful sentence that correctly uses a semicolon to join two ideas.", "difficulty": "Advanced",
                    "content": `<h2>Connecting Ideas with Style</h2><p>The semicolon is one of the most elegant and misunderstood punctuation marks. It is used to connect two closely related independent clauses, creating a more sophisticated link than a simple period.</p><blockquote>Example: The presentation was a success; the client was extremely pleased.</blockquote>`,
                    "quizzes": [{ "type": "sentence-correction", "prompt": "Correct this sentence using a semicolon:", "sentence": "The storm raged on, the house was shaking.", "answer": "The storm raged on; the house was shaking.", "explanation": "A semicolon can join two closely related independent clauses." }]
                }
                // ... PASTE THE REST OF YOUR 51 LESSON OBJECTS HERE ...
            },
            authKeys: new Set([ "academy-key-123", "inner-circle-2025", "bolu-vip-access" ])
        };

        const AppAuth = {
            login(key) { if (AppData.authKeys.has(key)) { localStorage.setItem('academy_session_definitive', 'true'); return true; } return false; },
            logout() { localStorage.removeItem('academy_session_definitive'); window.location.hash = ''; },
            isLoggedIn: () => localStorage.getItem('academy_session_definitive') === 'true'
        };
        // --- END OF EMBEDDED LOGIC ---

        // --- START OF RENDERER ---
        const AppRenderer = {
            renderLibrary(lessons, user) {
                const container = document.getElementById('app-container');
                let content = `<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div class="text-center mb-12"><h1 class="text-5xl font-bold">The Library</h1><p class="mt-4 text-lg text-gray-600">Browse our collection of lessons on the craft of writing.</p></div><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">`;
                Object.values(lessons).forEach(lesson => {
                    const isPremium = lesson.access === 'premium';
                    const isLocked = isPremium && !user;
                    const cardClass = isPremium ? (isLocked ? 'card-premium-locked' : 'card-premium-unlocked') : 'card-free';
                    const href = isLocked ? '#login' : `#lesson/${lesson.id}`;
                    const difficultyColor = {
                        "Beginner": "--success-green",
                        "Intermediate": "--intermediate-blue",
                        "Advanced": "--accent-gold"
                    }[lesson.difficulty] || "--bg-slate";
                    content += `<a href="${href}" class="bg-white p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300 block ${cardClass}"><div class="flex justify-between items-start"><h3 class="text-2xl font-bold pr-4">${lesson.title}</h3>${isPremium ? `<span class="flex-shrink-0 text-lg">${isLocked ? '🔒' : '⭐'}</span>` : ''}</div><p class="text-gray-600 mt-2 text-base">${lesson.summary}</p><p class="mt-2 text-sm font-semibold" style="color: var(${difficultyColor});">${lesson.difficulty}</p></a>`;
                });
                content += `</div></div>`;
                container.innerHTML = content;
            },
            renderLesson(lessonId, lessons, user) {
                const container = document.getElementById('app-container');
                const lesson = lessons[lessonId];
                if (!lesson) { container.innerHTML = '<h1 class="text-center">Lesson Not Found</h1>'; return; }
                if (lesson.access === 'premium' && !user) { this.renderLogin("This is a premium lesson. Please enter your access key."); return; }

                const difficultyColor = {
                    "Beginner": "--success-green",
                    "Intermediate": "--intermediate-blue",
                    "Advanced": "--accent-gold"
                }[lesson.difficulty] || "--bg-slate";

                container.innerHTML = `
                    <div class="lesson-container">
                        <div id="lesson-header" class="mb-8 border-b pb-6">
                            <h1 class="text-5xl font-bold mb-4">${lesson.title}</h1>
                            <p class="text-lg text-gray-600 italic">${lesson.summary}</p>
                            <p class="mt-4 text-lg font-semibold" style="color: var(${difficultyColor});">${lesson.difficulty}</p>
                        </div>
                        <div id="lesson-content"></div>
                        <div id="quiz-container" class="mt-12"></div>
                        <div id="lesson-spark" class="mt-12"></div>
                    </div>`;
                
                document.getElementById('lesson-content').innerHTML = marked.parse(lesson.content || '<p><em>Content coming soon.</em></p>');
                
                if (lesson.quizzes && lesson.quizzes.length > 0) {
                    this.renderQuiz(lesson.quizzes);
                }
                
                const sparkContainer = document.getElementById('lesson-spark');
                if(lesson.insightSpark) {
                    sparkContainer.innerHTML = `<h3 class="text-2xl mb-4">✨ Insight Spark</h3><p class="ui-font">${lesson.insightSpark}</p>`;
                }
            },
            renderQuiz(quizzes) {
                const quizContainer = document.getElementById('quiz-container');
                let quizHtml = '<div class="quiz-section space-y-8"><h3>Knowledge Check</h3>';
                quizzes.forEach((quiz, index) => {
                    quizHtml += `<div class="interaction-block" id="quiz-block-${index}">`;
                    if (quiz.type === 'multiple-choice') {
                        quizHtml += `<p class="font-bold mb-4 ui-font text-lg">${quiz.prompt}</p><div class="quiz-options space-y-3">`;
                        quiz.options.forEach((option) => {
                            quizHtml += `<label class="ui-font"><input type="radio" name="quiz-${index}" value="${option}" class="sr-only"><span class="option-text p-3 border rounded-md block cursor-pointer">${option}</span></label>`;
                        });
                        quizHtml += `</div>`;
                    } else if (quiz.type === 'fill-in-the-blank') {
                        const promptHtml = quiz.prompt.replace('___', `<input type="text" class="fill-in-blank-input" id="fill-in-${index}">`);
                        quizHtml += `<p class="font-bold mb-4 ui-font text-lg">${promptHtml}</p>`;
                    } else if (quiz.type === 'sentence-correction') {
                        quizHtml += `<p class="font-bold mb-4 ui-font text-lg">${quiz.prompt}</p><p class="italic text-gray-600 mb-2">"${quiz.sentence}"</p><textarea id="sentence-correction-${index}" class="w-full border rounded-md p-2 ui-font" rows="2"></textarea>`;
                    }
                    quizHtml += `<button class="mt-4 ui-font bg-slate-800 text-white px-4 py-2 rounded-md" style="background-color: var(--bg-slate);" onclick="AppRouter.checkAnswer(${index})">Check Answer</button><div id="feedback-${index}" class="mt-4"></div></div>`;
                });
                quizHtml += '</div>';
                quizContainer.innerHTML = quizHtml;
            },
            renderLogin(message) {
                const container = document.getElementById('app-container');
                container.innerHTML = `<div class="max-w-md mx-auto mt-10 p-8 space-y-6 bg-white rounded-lg shadow-xl"><div class="text-center"><h1 class="text-3xl font-bold">Member Access</h1><p class="mt-2 text-sm text-gray-600">${message}</p></div><form id="login-form" class="space-y-6"><input id="access-key" type="text" required class="relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 rounded-md ui-font" placeholder="Your Personal Access Key"><p id="error-message" class="text-sm text-red-600 hidden"></p><button type="submit" class="w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white ui-font" style="background-color: var(--bg-slate);">Unlock Academy</button></form></div>`;
                document.getElementById('login-form').addEventListener('submit', (e) => { e.preventDefault(); const key = document.getElementById('access-key').value; if (AppAuth.login(key)) { window.location.hash = ''; } else { const errorMsg = document.getElementById('error-message'); errorMsg.textContent = 'Invalid access key.'; errorMsg.classList.remove('hidden'); } });
            }
        };
        // --- END OF RENDERER ---

        // --- MAIN ROUTER ---
        const AppRouter = {
            run() {
                const user = AppAuth.isLoggedIn();
                const route = window.location.hash.substring(1);
                const authNav = document.getElementById('auth-nav');
                if (user) {
                    authNav.innerHTML = `<button id="logout-btn" class="font-bold hover:underline" style="color: var(--accent-gold);">Logout</button>`;
                    document.getElementById('logout-btn').addEventListener('click', AppAuth.logout);
                } else {
                    authNav.innerHTML = `<a href="#login" class="font-bold hover:underline">Member Login</a>`;
                }
                if (route.startsWith('lesson/')) {
                    AppRenderer.renderLesson(route.split('/')[1], AppData.lessons, user);
                } else if (route === 'login') {
                    AppRenderer.renderLogin("Enter your personal access key to unlock the premium library.");
                } else {
                    AppRenderer.renderLibrary(AppData.lessons, user);
                }
                feather.replace();
            },
            checkAnswer(quizIndex) {
                const route = window.location.hash.substring(1);
                const lessonId = route.split('/')[1];
                const lesson = AppData.lessons[lessonId];
                if (!lesson || !lesson.quizzes) return;

                const quiz = lesson.quizzes[quizIndex];
                const feedbackEl = document.getElementById(`feedback-${quizIndex}`);
                let isCorrect = false;

                if (quiz.type === 'multiple-choice') {
                    const selected = document.querySelector(`input[name="quiz-${quizIndex}"]:checked`);
                    if (selected && selected.value.toLowerCase() === quiz.answer.toLowerCase()) { isCorrect = true; }
                    const labels = document.querySelectorAll(`.quiz-options label`);
                    labels.forEach(label => {
                        const input = label.querySelector('input');
                        if (input.value.toLowerCase() === quiz.answer.toLowerCase()) {
                            label.classList.add('correct');
                        } else if (input.checked) {
                            label.classList.add('incorrect');
                        }
                    });
                } else if (quiz.type === 'fill-in-the-blank') {
                    const input = document.getElementById(`fill-in-${quizIndex}`);
                    if (input && input.value.trim().toLowerCase() === quiz.answer.toLowerCase()) { isCorrect = true; }
                } else if (quiz.type === 'sentence-correction') {
                    const textarea = document.getElementById(`sentence-correction-${quizIndex}`);
                    if (textarea && textarea.value.trim() === quiz.answer) { isCorrect = true; }
                }

                const feedback = document.createElement('div');
                feedback.className = `feedback ${isCorrect ? 'correct' : 'incorrect'}`;
                feedback.innerHTML = `<i data-feather="${isCorrect ? 'check-circle' : 'x-circle'}"></i> <strong>${isCorrect ? 'Correct!' : 'Not quite.'}</strong> ${quiz.explanation}`;
                feedbackEl.innerHTML = '';
                feedbackEl.appendChild(feedback);
                feather.replace();
                document.querySelector(`#quiz-block-${quizIndex}`).querySelectorAll('button, input, textarea').forEach(el => el.disabled = true);
            }
        };

        window.AppRouter = AppRouter; // Make checkAnswer globally accessible
        window.addEventListener('hashchange', AppRouter.run);
        document.addEventListener('DOMContentLoaded', AppRouter.run);
    </script>
</body>
</html>
