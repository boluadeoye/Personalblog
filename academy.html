<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Writer's Academy</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Lora:ital@0;1&family=Source+Sans+Pro&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <style>
        :root {
            --bg-main: #FDFDFD;
            --bg-header: #2D3748;
            --bg-quiz: #ffffff;
            --text-heading: #2D3748;
            --text-body: #374151;
            --text-subtle: #555;
            --text-light: #e2e8f0;
            --border-color: #e5e7eb;
            --accent-gold: #D4AF37;
            --accent-green: #8A9A5B;
            --success-green: #22c55e;
            --error-red: #ef4444;
            --intermediate-blue: #3b82f6;
        }
        
        body { background-color: var(--bg-main); font-family: 'Lora', serif; color: var(--text-body); }
        h1, h2, h3, h4 { font-family: 'Playfair Display', serif; color: var(--text-heading); }
        .ui-font { font-family: 'Source Sans Pro', sans-serif; }
        header { background-color: var(--bg-header); }
        .card { background-color: var(--bg-quiz); }
        .card-premium-unlocked { border-left: 4px solid var(--accent-gold); }
        .card-premium-locked { border-left: 4px solid #4b5563; }
        .card-free { border-left: 4px solid var(--accent-green); }
        
        .lesson-container { max-width: 800px; margin-left: auto; margin-right: auto; padding-left: 1rem; padding-right: 1rem; }
        #lesson-header { text-align: center; margin-bottom: 2rem; padding-bottom: 1.5rem; border-bottom: 1px solid var(--border-color); }
        
        #lesson-content { padding-top: 1rem; }
        #lesson-content h2 { font-size: 1.75rem; margin-top: 3rem; margin-bottom: 1rem; padding-bottom: 0.75rem; border-bottom: 1px dashed var(--border-color); }
        #lesson-content p { font-size: 1.125rem; line-height: 1.8; margin-bottom: 1.75rem; }
        #lesson-content blockquote { border-left: 4px solid var(--accent-gold); padding-left: 1.75rem; margin: 2rem 0; font-style: italic; color: var(--text-subtle); background-color: #fffdf7; }
        #lesson-content ul, #lesson-content ol { margin: 2rem 0 2rem 2.5rem; }
        #lesson-content li { margin-bottom: 1rem; padding-left: 0.5rem; line-height: 1.8; }
        
        .difficulty-beginner { color: var(--success-green); }
        .difficulty-intermediate { color: var(--intermediate-blue); }
        .difficulty-advanced { color: var(--accent-gold); }
        .difficulty-indicator { display: inline-flex; align-items: center; gap: 0.5rem; }

        .quiz-section { background-color: var(--bg-quiz); border: 1px solid var(--border-color); border-radius: 8px; padding: 24px; margin-top: 40px; }
        
        #lesson-spark {
            margin-top: 3rem; padding: 24px;
            background-color: var(--bg-header);
            color: var(--text-light);
            border-radius: 8px;
            border-left: 4px solid var(--accent-gold);
        }
        #lesson-spark h3 { color: #ffffff; }

        .animatable { opacity: 0; }
    </style>
</head>
<body>

    <header class="text-white shadow-lg">
        <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-20">
                <a href="./academy.html" class="flex items-center gap-2">
                    <svg class="h-8 w-8" viewBox="0 0 24 24"><path d="M12 2 L2 22 H22 Z M12 6 L18.3 18 H5.7 Z" fill="var(--accent-gold)"/></svg>
                    <span class="font-bold text-2xl">The Academy</span>
                </a>
                <div id="auth-nav" class="text-sm ui-font"></div>
            </div>
        </nav>
    </header>

    <main id="app-container" class="py-12"></main>

    <footer class="mt-24 py-8 text-center text-gray-400" style="background-color: var(--bg-header);">
        <p class="ui-font">¬© 2025 Boluadeoye ‚Ä¢ Crafted with passion</p>
    </footer>

    <script>
        // --- START OF EMBEDDED DATABASE AND AUTH LOGIC ---
        const AppData = {
            lessons: {
                "gram001": { "id": "gram001", "title": "Mastering Subject-Verb Agreement", "access": "free", "summary": "Learn the foundational rule of English syntax.", "insightSpark": "Find a complex paragraph in a book. Why does the subject-verb agreement work? Analyze three sentences.", "difficulty": "Beginner", "content": `<h2>The Core Rule</h2><p>At its heart, subject-verb agreement is simple: a singular subject takes a singular verb, and a plural subject takes a plural verb...</p>` },
                "gram002": { "id": "gram002", "title": "Mastering Pronoun Usage", "access": "free", "summary": "Avoid ambiguity with correct pronoun usage.", "insightSpark": "Write a sentence where the pronoun 'it' is ambiguous, then rewrite it for clarity.", "difficulty": "Beginner", "content": `<h2>The Role of the Pronoun</h2><p>Pronouns are the efficient stand-ins of the English language...</p>` },
                "gram003": { "id": "gram003", "title": "The Art of the Semicolon", "access": "premium", "summary": "Connect related clauses with style.", "insightSpark": "Craft a single, beautiful sentence that correctly uses a semicolon to join two ideas.", "difficulty": "Intermediate", "content": `<h2>Connecting Ideas with Style</h2><p>The semicolon (;) is one of the most elegant and misunderstood punctuation marks...</p>` }
            },
            authKeys: new Set([ "academy-key-123", "inner-circle-2025", "bolu-vip-access" ])
        };

        const AppAuth = {
            login(key) { if (AppData.authKeys.has(key)) { localStorage.setItem('academy_session_definitive', 'true'); return true; } return false; },
            logout() { localStorage.removeItem('academy_session_definitive'); window.location.hash = ''; },
            isLoggedIn: () => localStorage.getItem('academy_session_definitive') === 'true'
        };
        // --- END OF EMBEDDED LOGIC ---

        // --- ANIMATION HELPER ---
        const AppAnimation = {
            staggerIn(targets, delay = 100) {
                anime({ targets, translateY: [20, 0], opacity: [0, 1], delay: anime.stagger(100, { start: delay }), duration: 500, easing: 'easeOutQuad' });
            },
            fadeIn(targets, delay = 100) {
                anime({ targets, translateY: [10, 0], opacity: [0, 1], delay, duration: 600, easing: 'easeOutQuad' });
            }
        };

        // --- START OF RENDERER ---
        const AppRenderer = {
            renderLibrary(lessons, user) {
                const container = document.getElementById('app-container');
                let content = `<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div class="text-center mb-12 animatable"><h1 class="text-5xl font-bold">The Library</h1><p class="mt-4 text-lg text-gray-600">Browse our collection of lessons on the craft of writing.</p></div><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">`;
                Object.values(lessons).forEach(lesson => {
                    const isPremium = lesson.access === 'premium';
                    const isLocked = isPremium && !user;
                    const cardClass = isPremium ? (isLocked ? 'card-premium-locked' : 'card-premium-unlocked') : 'card-free';
                    const href = isLocked ? '#login' : `#lesson/${lesson.id}`;
                    const difficultyClass = `difficulty-${(lesson.difficulty || 'beginner').toLowerCase()}`;
                    content += `
                        <a href="${href}" class="card p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300 block ${cardClass} animatable">
                            <div class="flex justify-between items-start"><h3 class="text-2xl font-bold pr-4">${lesson.title}</h3>${isPremium ? `<span class="flex-shrink-0 text-lg">${isLocked ? 'üîí' : '‚≠ê'}</span>` : ''}</div>
                            <p class="text-gray-600 mt-2 text-base">${lesson.summary}</p>
                            <p class="mt-4 text-sm font-bold ui-font ${difficultyClass} difficulty-indicator"><i data-feather="bar-chart-2" class="w-4 h-4"></i><span>${lesson.difficulty || 'N/A'}</span></p>
                        </a>`;
                });
                content += `</div></div>`;
                container.innerHTML = content;
                AppAnimation.staggerIn('.animatable');
            },
            renderLesson(lessonId, lessons, user) {
                const container = document.getElementById('app-container');
                const lesson = lessons[lessonId];
                if (!lesson) { container.innerHTML = '<h1 class="text-center">Lesson Not Found</h1>'; return; }
                if (lesson.access === 'premium' && !user) { this.renderLogin("This is a premium lesson. Please enter your access key."); return; }

                const difficultyClass = `difficulty-${(lesson.difficulty || 'beginner').toLowerCase()}`;

                container.innerHTML = `
                    <div class="lesson-container">
                        <div id="lesson-header" class="animatable">
                            <h1 class="text-5xl font-bold mb-4">${lesson.title}</h1>
                            <p class="text-lg text-gray-600 italic mb-4">${lesson.summary}</p>
                            <p class="mt-4 text-lg font-bold ui-font ${difficultyClass} difficulty-indicator"><i data-feather="bar-chart-2" class="w-5 h-5"></i><span>${lesson.difficulty}</span></p>
                        </div>
                        <div id="lesson-content" class="animatable"></div>
                        <div id="quiz-container" class="mt-16 animatable"></div>
                        <div id="lesson-spark" class="mt-16 animatable"></div>
                    </div>`;
                
                document.getElementById('lesson-content').innerHTML = marked.parse(lesson.content || '<p><em>Content coming soon.</em></p>');
                
                if (lesson.quizzes) { /* Quiz rendering logic */ }
                
                const sparkContainer = document.getElementById('lesson-spark');
                if(lesson.insightSpark) {
                    sparkContainer.innerHTML = `
                        <h3 class="text-3xl font-bold flex items-center gap-3"><span style="color: var(--accent-gold);">‚ú®</span> Insight Spark</h3>
                        <p class="ui-font text-lg mt-4">${lesson.insightSpark}</p>`;
                }

                // Animate content in a sequence for a more graceful feel
                AppAnimation.fadeIn('#lesson-header');
                AppAnimation.fadeIn('#lesson-content', 300);
                AppAnimation.fadeIn('#quiz-container', 400);
                AppAnimation.fadeIn('#lesson-spark', 500); // Insight Spark animates last
            },
            renderLogin(message) {
                const container = document.getElementById('app-container');
                container.innerHTML = `<div class="max-w-md mx-auto mt-10 p-8 space-y-6 card rounded-lg shadow-xl animatable"><div class="text-center"><h1 class="text-3xl font-bold">Member Access</h1><p class="mt-2 text-sm text-gray-600">${message}</p></div><form id="login-form" class="space-y-6"><input id="access-key" type="text" required class="relative block w-full px-3 py-3 border border-[var(--border-color)] placeholder-gray-500 rounded-md ui-font" placeholder="Your Personal Access Key"><p id="error-message" class="text-sm text-red-600 hidden"></p><button type="submit" class="w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white ui-font" style="background-color: var(--bg-header);">Unlock Academy</button></form></div>`;
                document.getElementById('login-form').addEventListener('submit', (e) => { e.preventDefault(); const key = document.getElementById('access-key').value; if (AppAuth.login(key)) { window.location.hash = ''; } else { const errorMsg = document.getElementById('error-message'); errorMsg.textContent = 'Invalid access key.'; errorMsg.classList.remove('hidden'); } });
                AppAnimation.fadeIn('.animatable');
            }
        };
        // --- END OF RENDERER ---

        // --- MAIN ROUTER ---
        const AppRouter = {
            run() {
                const user = AppAuth.isLoggedIn();
                const route = window.location.hash.substring(1);
                const authNav = document.getElementById('auth-nav');
                if (user) {
                    authNav.innerHTML = `<button id="logout-btn" class="font-bold hover:underline" style="color: var(--accent-gold);">Logout</button>`;
                    document.getElementById('logout-btn').addEventListener('click', AppAuth.logout);
                } else {
                    authNav.innerHTML = `<a href="#login" class="font-bold hover:underline">Member Login</a>`;
                }
                if (route.startsWith('lesson/')) {
                    AppRenderer.renderLesson(route.split('/')[1], AppData.lessons, user);
                } else if (route === 'login') {
                    AppRenderer.renderLogin("Enter your personal access key to unlock the premium library.");
                } else {
                    AppRenderer.renderLibrary(AppData.lessons, user);
                }
                feather.replace();
            }
        };

        window.AppRouter = AppRouter;
        window.addEventListener('hashchange', AppRouter.run);
        document.addEventListener('DOMContentLoaded', AppRouter.run);
    </script>
</body>
</html>
